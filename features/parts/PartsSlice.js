import { createSlice, createAsyncThunk } from "@reduxjs/toolkit";
import { addNotification } from "../notifications/NotificationsSlice";

export const addPart = createAsyncThunk(
    'parts/addPart',
    async (part, {rejectWithValue, dispatch}) => {
        try {
            await new Promise((resolve) => {
                setTimeout(() => {
                    resolve();
                }, 1000);
            })
            if (part.expectedStatus === 'error') throw new Error('System error!')
            return part;
        }
        catch(error) {
            dispatch(addNotification({text: error.message}))
            return rejectWithValue();
        }
    }
)

export const partsSlice = createSlice({
    name: "parts",
    initialState: {
        status: null,
        data: [
            {
                id: 1,
                name: "Левое переднее крыло",
                expectedStatus: "success",
                damaged: false,
                path: "M53.312 33.1846C52 27.3156 44.812 23.3826 40.5 21.8226C37.312 20.6356 31.6251 20.4486 27.312 20.5106C25.7578 20.535 24.2758 21.1714 23.1878 22.2816C22.0997 23.3917 21.4933 24.8861 21.5 26.4406L21.562 38.5516H21.875C35.625 38.5516 46.75 49.6646 46.75 63.3986C46.75 77.0706 35.625 88.1826 21.937 88.1826L22.062 103.978C22.062 105.788 23.5 107.349 25.312 107.474L58.125 109.784C58.5704 109.815 59.0171 109.748 59.4338 109.588C59.8506 109.428 60.2271 109.178 60.5369 108.857C60.8468 108.535 61.0824 108.15 61.2272 107.728C61.372 107.305 61.4225 106.856 61.375 106.413C60 92.1786 54.937 40.4876 53.312 33.1826V33.1846Z"
            },
            {
                id: 2,
                name: "Левое переднее колесо",
                expectedStatus: "success",
                damaged: false,
                path: "M21.75 84.3431C33.21 84.3431 42.5 75.0631 42.5 63.6161C42.5 52.1701 33.21 42.8901 21.75 42.8901C10.29 42.8901 1 52.1701 1 63.6161C1 75.0631 10.29 84.3431 21.75 84.3431Z"
            },
            {
                id: 3,
                name: "Левая передняя дверь",
                expectedStatus: "success",
                damaged: false,
                path: "M26.0651 111.513L56.5021 113.448C59.0651 113.636 61.1281 115.758 61.1281 118.318L61.6901 167.075C61.6901 168.885 60.1281 170.321 58.3151 170.071L27.0651 166.138C25.5981 165.966 24.2457 165.26 23.2659 164.155C22.286 163.05 21.7472 161.622 21.7521 160.145V115.508C21.7521 113.198 23.6901 111.326 26.0651 111.513V111.513Z"
            },
            {
                id: 4,
                name: "Левый порог",
                expectedStatus: "success",
                damaged: false,
                path: "M11.4399 85.717L15.6899 87.09C16.8779 87.465 17.6899 88.589 17.6899 89.837V229.303C17.6899 230.614 16.7519 231.8 15.5019 232.05L11.7519 232.924C11.3356 233.026 10.9016 233.032 10.4826 232.942C10.0636 232.851 9.67071 232.667 9.33354 232.402C8.99637 232.138 8.72378 231.8 8.5364 231.414C8.34902 231.029 8.25175 230.606 8.25194 230.177L7.68994 88.464C7.75194 86.528 9.62794 85.155 11.4399 85.717Z"
            },
            {
                id: 5,
                name: "Левое заднее колесо",
                expectedStatus: "success",
                damaged: false,
                path: "M26.5 275.683C37.96 275.683 47.25 266.403 47.25 254.956C47.25 243.51 37.96 234.23 26.5 234.23C15.04 234.23 5.75 243.51 5.75 254.956C5.75 266.403 15.04 275.683 26.5 275.683Z"
            },
            {
                id: 6,
                name: "Левая задняя дверь",
                expectedStatus: "success",
                damaged: false,
                path: "M25.2549 169.936L58.0049 174.056C60.0049 174.306 61.4429 175.992 61.4429 177.99V227.496C61.4429 229.244 59.5669 230.43 58.0049 229.618L47.3799 224.312C45.5669 223.375 44.0049 221.939 43.0049 220.129L41.3799 217.195C40.1727 215.062 38.2105 213.458 35.8799 212.7L28.6299 210.453C24.3169 209.142 21.3799 205.146 21.3799 200.65V173.307C21.5049 171.247 23.2549 169.687 25.2549 169.937V169.936Z"
            },
            {
                id: 7,
                name: "Левое заднее крыло",
                expectedStatus: "success",
                damaged: false,
                path: "M62.1281 278.185L61.5661 239.416C61.5661 238.043 60.8161 236.732 59.5661 236.108L43.3161 226.993C42.0661 226.306 41.0661 225.307 40.3161 224.183L37.5661 220.001C36.5661 218.503 35.1281 217.317 33.3781 216.692L24.8161 213.696C23.5031 213.259 22.1901 214.382 22.4401 215.756L25.1901 229.927H26.2521C40.3771 229.927 51.8151 241.352 51.8151 255.461C51.8151 266.573 44.6901 276 34.7521 279.558L37.1901 292.231C37.6271 294.604 40.1271 296.039 42.4401 295.228C45.6271 294.042 50.1901 292.356 54.7521 290.546C63.1271 287.112 62.1271 278.185 62.1271 278.185H62.1281Z"
            },
            {
                id: 8,
                name: "Левое переднее окно",
                expectedStatus: "success",
                damaged: false,
                path: "M64.0001 122.92L64.1251 122.232C66.5631 121.17 68.1251 122.794 69.3751 125.041C69.3751 125.041 75.0631 132.033 80.0631 146.579C85.0631 161.125 85.6881 170.739 85.6881 170.739C86.0631 172.299 85.3751 173.735 83.8131 173.486L68.2501 171.052C66.5001 170.802 65.2501 169.304 65.1871 167.556L64.0001 122.92Z"
            },
            {
                id: 9,
                name: "Левое заднее окно",
                expectedStatus: "success",
                damaged: false,
                path: "M65.5601 177.927C65.5601 176.616 66.7481 175.554 68.0601 175.742L83.0601 177.802C85.0601 178.114 86.4351 179.862 86.3101 181.797C85.7471 189.975 83.7471 210.389 78.8101 218.006C75.3101 223.375 71.8101 226.996 69.3721 229.056C68.1221 230.179 66.1851 229.306 66.1221 227.62L65.5601 177.927Z"
            },
            {
                id: 10,
                name: "Правое переднее колесо",
                expectedStatus: "success",
                damaged: false,
                path: "M215.25 84.3431C226.71 84.3431 236 75.0631 236 63.6161C236 52.1701 226.71 42.8901 215.25 42.8901C203.79 42.8901 194.5 52.1701 194.5 63.6161C194.5 75.0631 203.79 84.3431 215.25 84.3431Z"
            },
            {
                id: 11,
                name: "Правое переднее крыло",
                expectedStatus: "success",
                damaged: false,
                path: "M183.998 33.1846C185.31 27.3156 192.498 23.3826 196.81 21.8226C199.998 20.6356 205.685 20.4486 209.998 20.5106C211.552 20.535 213.034 21.1714 214.122 22.2816C215.21 23.3917 215.817 24.8861 215.81 26.4406L215.748 38.5516H215.435C201.685 38.5516 190.56 49.6646 190.56 63.3986C190.56 77.0706 201.685 88.1826 215.373 88.1826L215.248 103.978C215.248 105.788 213.81 107.349 211.998 107.474L179.185 109.784C178.74 109.815 178.293 109.748 177.876 109.588C177.46 109.428 177.083 109.178 176.773 108.857C176.463 108.535 176.228 108.15 176.083 107.728C175.938 107.305 175.888 106.856 175.935 106.413C177.31 92.1786 182.373 40.4876 183.998 33.1826V33.1846Z"
            },
            {
                id: 12,
                name: "Правый порог",
                expectedStatus: "success",
                damaged: false,
                path: "M225.63 85.717L221.38 87.09C220.799 87.2776 220.292 87.6446 219.933 88.1381C219.574 88.6317 219.38 89.2265 219.38 89.837V229.303C219.38 230.614 220.317 231.8 221.568 232.05L225.318 232.924C225.734 233.026 226.168 233.032 226.587 232.942C227.006 232.851 227.399 232.667 227.736 232.402C228.073 232.138 228.346 231.8 228.533 231.414C228.721 231.029 228.818 230.606 228.818 230.177L229.38 88.464C229.317 86.528 227.442 85.155 225.63 85.717Z"
            },
            {
                id: 13,
                name: "Правое заднее колесо",
                expectedStatus: "success",
                damaged: false,
                path: "M210.56 275.683C222.02 275.683 231.31 266.403 231.31 254.956C231.31 243.51 222.02 234.23 210.56 234.23C199.1 234.23 189.81 243.51 189.81 254.956C189.81 266.403 199.1 275.683 210.56 275.683Z"
            },
            {
                id: 14,
                name: "Правая передняя дверь",
                expectedStatus: "success",
                damaged: false,
                path: "M211.245 111.513L180.808 113.448C178.245 113.636 176.182 115.758 176.182 118.318L175.62 167.075C175.62 168.885 177.182 170.321 178.995 170.071L210.245 166.138C211.712 165.966 213.064 165.26 214.044 164.155C215.024 163.05 215.563 161.622 215.558 160.145V115.508C215.558 113.198 213.62 111.326 211.245 111.513Z"
            },
            {
                id: 15,
                name: "Правая задняя дверь",
                expectedStatus: "success",
                damaged: false,
                path: "M211.808 169.936L179.058 174.056C177.058 174.307 175.62 175.993 175.62 177.99V227.496C175.62 229.244 177.495 230.43 179.058 229.618L189.682 224.312C191.495 223.375 193.058 221.939 194.058 220.129L195.683 217.195C196.89 215.062 198.852 213.458 201.183 212.7L208.433 210.453C212.745 209.142 215.683 205.146 215.683 200.651V173.307C215.557 171.247 213.807 169.687 211.807 169.937L211.808 169.936Z"
            },
            {
                id: 16,
                name: "Правое заднее крыло",
                expectedStatus: "success",
                damaged: false,
                path: "M174.938 278.185L175.5 239.416C175.5 238.043 176.25 236.732 177.5 236.108L193.688 226.993C194.938 226.306 195.938 225.307 196.688 224.183L199.438 220.001C200.438 218.503 201.875 217.317 203.625 216.692L212.188 213.696C213.5 213.259 214.813 214.382 214.563 215.756L211.813 229.927H210.75C196.625 229.927 185.188 241.352 185.188 255.461C185.188 266.573 192.313 276 202.25 279.558L199.813 292.231C199.375 294.604 196.875 296.039 194.563 295.228C191.375 294.042 186.813 292.356 182.25 290.546C173.938 287.112 174.938 278.185 174.938 278.185Z"
            },
            {
                id: 17,
                name: "Капот",
                expectedStatus: "success",
                damaged: false,
                path: "M167.814 38.897C167.751 35.713 165.876 32.841 163.001 31.406C155.251 27.66 138.626 20.98 118.564 20.98C98.4998 20.98 81.8758 27.66 74.1258 31.406C71.2508 32.779 69.3758 35.713 69.3138 38.897L67.4998 105.51C67.4398 107.943 69.9398 109.69 72.1898 108.755C80.1258 105.446 97.2498 99.64 118.5 99.64C139.75 99.64 156.938 105.446 164.875 108.693C167.125 109.629 169.625 107.881 169.563 105.446L167.813 38.897H167.814Z"
            },
            {
                id: 18,
                name: "Лобовое стекло",
                expectedStatus: "success",
                damaged: false,
                path: "M163.814 113.058C156.628 109.748 142.378 104.442 118.564 104.38C94.7521 104.38 80.5031 109.749 73.3141 113.058C70.8771 114.18 69.8771 117.178 71.2521 119.55L78.7521 132.41C79.2073 133.197 79.9482 133.779 80.8211 134.035C81.6939 134.291 82.6318 134.201 83.4401 133.784C88.8141 131.1 99.9401 126.293 118.627 126.293C137.315 126.293 148.44 131.099 153.815 133.784C154.627 134.182 155.558 134.262 156.425 134.008C157.293 133.753 158.034 133.184 158.502 132.411L166.002 119.551C167.252 117.178 166.252 114.181 163.814 113.058Z"
            },
            {
                id: 19,
                name: "Правое переднее стекло",
                expectedStatus: "success",
                damaged: false,
                path: "M173.058 122.92L172.933 122.233C170.495 121.171 168.933 122.795 167.683 125.042C167.683 125.042 161.995 132.034 156.995 146.58C151.995 161.126 151.37 170.74 151.37 170.74C150.995 172.3 151.683 173.736 153.245 173.487L168.808 171.052C170.558 170.802 171.808 169.304 171.87 167.556L173.058 122.92Z"
            },
            {
                id: 20,
                name: "Правое заднее стекло",
                expectedStatus: "success",
                damaged: false,
                path: "M171.498 177.927C171.498 176.616 170.31 175.554 168.998 175.742L153.998 177.802C151.998 178.114 150.623 179.862 150.748 181.797C151.31 189.975 153.31 210.389 158.248 218.006C161.748 223.375 165.248 226.996 167.685 229.056C168.935 230.179 170.873 229.306 170.935 227.62L171.498 177.927Z"
            },
            {
                id: 21,
                name: "Крыша",
                expectedStatus: "error",
                damaged: false,
                path: "M153.56 219.817C151.123 214.448 145.81 200.339 145.81 179.177C145.81 167.065 151.248 148.524 153.623 141.719C154.248 139.909 153.311 138.098 151.623 137.224C143.498 133.228 132.623 129.982 118.561 129.67C104.498 129.982 93.6233 133.228 85.4983 137.224C83.8113 138.098 82.8733 139.908 83.4983 141.719C85.9363 148.524 91.3113 167.065 91.3113 179.176C91.3113 200.339 85.9983 214.448 83.5613 219.817C82.8733 221.378 83.3113 223.126 84.6863 224.125C89.1233 227.371 100.123 233.676 118.623 233.427C137.123 233.676 148.061 227.371 152.561 224.125C153.811 223.126 154.248 221.315 153.561 219.817H153.56Z"
            },
            {
                id: 22,
                name: "Заднее стекло",
                expectedStatus: "success",
                damaged: false,
                path: "M168.504 236.54L159.254 227.3C158.191 226.24 156.441 226.114 155.254 227.05C141.504 237.913 119.066 238.226 118.504 238.226C117.941 238.226 95.5042 237.913 81.8161 227.051C80.6291 226.114 78.8791 226.239 77.8161 227.301L68.5662 236.54C67.3792 237.726 67.4412 239.662 68.7542 240.723C74.4411 245.593 90.8792 257.142 118.504 257.142C146.129 257.142 162.566 245.592 168.254 240.722C169.629 239.662 169.691 237.726 168.504 236.54Z"
            },
            {
                id: 23,
                name: "Багажник",
                expectedStatus: "success",
                damaged: false,
                path: "M167.31 248.155C160.497 253.21 144.685 262.45 118.497 263.2C92.3101 262.45 76.4981 253.211 69.6861 248.155C68.0601 246.968 65.8101 248.092 65.8101 250.09V287.61C65.8101 291.043 67.5601 294.29 70.4351 296.162C78.6231 301.47 96.8101 311.52 118.435 312.456C140.06 311.52 158.248 301.469 166.435 296.162C167.854 295.231 169.019 293.962 169.826 292.469C170.634 290.977 171.058 289.307 171.06 287.61V250.09C171.185 248.092 168.935 246.968 167.31 248.155Z"
            },
            {
                id: 24,
                name: "Передний бампер",
                expectedStatus: "success",
                damaged: false,
                path: "M169.126 12.112C160.688 8.492 142.126 1 118.563 1C95.0007 1 76.3757 8.491 67.9377 12.112C64.8127 13.486 63.3127 17.107 64.6257 20.228L68.5627 25.722C69.2507 27.407 71.1877 28.156 72.8757 27.47C79.8757 24.41 98.5627 16.607 118.501 16.607C138.438 16.607 157.126 24.411 164.188 27.532C164.585 27.708 165.013 27.8024 165.447 27.8094C165.881 27.8164 166.313 27.736 166.715 27.5729C167.117 27.4098 167.483 27.1673 167.79 26.86C168.096 26.5527 168.338 26.1867 168.501 25.784L172.438 20.291C173.751 17.107 172.313 13.486 169.126 12.112Z"
            },
            {
                id: 25,
                name: "Задний бампер",
                expectedStatus: "success",
                damaged: false,
                path: "M171.94 312.205L170.44 307.024C169.752 305.338 167.877 302.904 164.752 304.589C157.94 308.209 138.502 316.888 118.502 316.888C98.5648 316.888 79.1268 308.272 72.2518 304.589C69.1268 302.903 67.2518 305.339 66.5648 307.024L65.0648 312.205C63.7518 315.389 66.0648 317.325 69.2518 318.635C77.6898 322.256 94.8768 329.935 118.502 329.997C142.065 329.997 159.252 322.257 167.752 318.636C170.94 317.325 173.252 315.389 171.94 312.206V312.205Z"
            },
        ]
    },
    reducers: {
        removeSelection: (state, action) => {
            return {
                ...state, 
                data: state.data.map(part => part.id === action.payload.id ? 
                        {...part, damaged: false} : 
                        part
                    )
            }
        }
    },
    extraReducers: bulder => {
        bulder.addCase(addPart.pending, state => {
            state.status = 'pending'
        })
        .addCase(addPart.fulfilled, (state, action) => {
            state.status = null
            state.data.map(part => {
                if (part.id === action.payload.id) part.damaged = true;
                return part;
            })
        })
        .addCase(addPart.rejected, state => {
            state.status = null;
        })
    } 
})


export default partsSlice.reducer;
export const {removeSelection} = partsSlice.actions